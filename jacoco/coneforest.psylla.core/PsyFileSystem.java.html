<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PsyFileSystem.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Psylla v0.23.4</a> &gt; <a href="index.source.html" class="el_package">coneforest.psylla.core</a> &gt; <span class="el_source">PsyFileSystem.java</span></div><h1>PsyFileSystem.java</h1><pre class="source lang-java linenums">package coneforest.psylla.core;

import coneforest.psylla.runtime.*;
import java.io.IOError;
import java.io.IOException;
import java.nio.file.AccessDeniedException;
import java.nio.file.DirectoryNotEmptyException;
import java.nio.file.FileAlreadyExistsException;
import java.nio.file.Files;
import java.nio.file.LinkOption;
import java.nio.file.NoSuchFileException;
import java.nio.file.NotDirectoryException;
import java.nio.file.NotLinkException;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.attribute.BasicFileAttributes;
import java.nio.file.attribute.PosixFilePermission;
import java.util.HashSet;

/**
*	An utility class providing filesystem-related methods.
*/
@Type(&quot;filesystem&quot;)
public interface PsyFileSystem
{
	/**
	*	Context action of the {@code changefilepermissions} operator.
	*/
	@OperatorType(&quot;changefilepermissions&quot;)
<span class="fc" id="L30">	public static final ContextAction PSY_CHANGEFILEPERMISSIONS</span>
<span class="fc" id="L31">		=ContextAction.&lt;PsyString, PsyInteger&gt;ofBiConsumer(PsyFileSystem::psyChangeFilePermissions);</span>

	/**
	*	Context action of the {@code copyfile} operator.
	*/
	@OperatorType(&quot;copyfile&quot;)
<span class="fc" id="L37">	public static final ContextAction PSY_COPYFILE</span>
<span class="fc" id="L38">		=ContextAction.&lt;PsyString, PsyString&gt;ofBiConsumer(PsyFileSystem::psyCopyFile);</span>

	/**
	*	Context action of the {@code createdirectory} operator.
	*/
	@OperatorType(&quot;createdirectory&quot;)
<span class="fc" id="L44">	public static final ContextAction PSY_CREATEDIRECTORY</span>
<span class="fc" id="L45">		=ContextAction.&lt;PsyString&gt;ofConsumer(PsyFileSystem::psyCreateDirectory);</span>

	/**
	*	Context action of the {@code currentdirectory} operator.
	*/
	@OperatorType(&quot;currentdirectory&quot;)
<span class="fc" id="L51">	public static final ContextAction PSY_CURRENTDIRECTORY</span>
<span class="fc" id="L52">		=ContextAction.ofSupplier(PsyFileSystem::psyCurrentDirectory);</span>

	/**
	*	Context action of the {@code deletefile} operator.
	*/
	@OperatorType(&quot;deletefile&quot;)
<span class="fc" id="L58">	public static final ContextAction PSY_DELETEFILE</span>
<span class="fc" id="L59">		=ContextAction.&lt;PsyString&gt;ofConsumer(PsyFileSystem::psyDeleteFile);</span>

	/**
	*	Context action of the {@code fileaccesstime} operator.
	*/
	@OperatorType(&quot;fileaccesstime&quot;)
<span class="fc" id="L65">	public static final ContextAction PSY_FILEACCESSTIME</span>
<span class="fc" id="L66">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyFileAccessTime);</span>

	/**
	*	Context action of the {@code fileabsolutepath} operator.
	*/
	@OperatorType(&quot;fileabsolutepath&quot;)
<span class="fc" id="L72">	public static final ContextAction PSY_FILEABSOLUTEPATH</span>
<span class="fc" id="L73">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyFileAbsolutePath);</span>

	/**
	*	Context action of the {@code fileattribute} operator.
	*/
	@OperatorType(&quot;fileattribute&quot;)
<span class="fc" id="L79">	public static final ContextAction PSY_FILEATTRIBUTE</span>
<span class="fc" id="L80">		=ContextAction.&lt;PsyString, PsyString&gt;ofBiFunction(PsyFileSystem::psyFileAttribute);</span>

	/**
	*	Context action of the {@code filecreationtime} operator.
	*/
	@OperatorType(&quot;filecreationtime&quot;)
<span class="fc" id="L86">	public static final ContextAction PSY_FILECREATIONTIME</span>
<span class="fc" id="L87">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyFileCreationTime);</span>

	/**
	*	Context action of the {@code fileexists} operator.
	*/
	@OperatorType(&quot;fileexists&quot;)
<span class="fc" id="L93">	public static final ContextAction PSY_FILEEXISTS</span>
<span class="fc" id="L94">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyFileExists);</span>

	/**
	*	Context action of the {@code filemodifiedtime} operator.
	*/
	@OperatorType(&quot;filemodifiedtime&quot;)
<span class="fc" id="L100">	public static final ContextAction PSY_FILEMODIFIEDTIME</span>
<span class="fc" id="L101">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyFileModifiedTime);</span>

	/**
	*	Context action of the {@code filepermissions} operator.
	*/
	@OperatorType(&quot;filepermissions&quot;)
<span class="fc" id="L107">	public static final ContextAction PSY_FILEPERMISSIONS</span>
<span class="fc" id="L108">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyFilePermissions);</span>

	/**
	*	Context action of the {@code files} operator.
	*/
	@OperatorType(&quot;files&quot;)
<span class="fc" id="L114">	public static final ContextAction PSY_FILES</span>
<span class="fc" id="L115">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyFiles);</span>

	/**
	*	Context action of the {@code filesize} operator.
	*/
	@OperatorType(&quot;filesize&quot;)
<span class="fc" id="L121">	public static final ContextAction PSY_FILESIZE</span>
<span class="fc" id="L122">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyFileSize);</span>

	/**
	*	Context action of the {@code hardlink} operator.
	*/
	@OperatorType(&quot;hardlink&quot;)
<span class="fc" id="L128">	public static final ContextAction PSY_HARDLINK</span>
<span class="fc" id="L129">		=ContextAction.&lt;PsyString, PsyString&gt;ofBiConsumer(PsyFileSystem::psyHardlink);</span>

	/**
	*	Context action of the {@code isdirectory} operator.
	*/
	@OperatorType(&quot;isdirectory&quot;)
<span class="fc" id="L135">	public static final ContextAction PSY_ISDIRECTORY</span>
<span class="fc" id="L136">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyIsDirectory);</span>

	/**
	*	Context action of the {@code isfile} operator.
	*/
	@OperatorType(&quot;isfile&quot;)
<span class="fc" id="L142">	public static final ContextAction PSY_ISFILE</span>
<span class="fc" id="L143">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyIsFile);</span>

	/**
	*	Context action of the {@code issamefile} operator.
	*/
	@OperatorType(&quot;issamefile&quot;)
<span class="fc" id="L149">	public static final ContextAction PSY_ISSAMEFILE</span>
<span class="fc" id="L150">		=ContextAction.&lt;PsyString, PsyString&gt;ofBiFunction(PsyFileSystem::psyIsSameFile);</span>

	/**
	*	Context action of the {@code issymlink} operator.
	*/
	@OperatorType(&quot;issymlink&quot;)
<span class="fc" id="L156">	public static final ContextAction PSY_ISSYMLINK</span>
<span class="fc" id="L157">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyIsSymlink);</span>

	/**
	*	Context action of the {@code readlink} operator.
	*/
	@OperatorType(&quot;readlink&quot;)
<span class="fc" id="L163">	public static final ContextAction PSY_READLINK</span>
<span class="fc" id="L164">		=ContextAction.&lt;PsyString&gt;ofFunction(PsyFileSystem::psyReadLink);</span>

	/**
	*	Context action of the {@code renamefile} operator.
	*/
	@OperatorType(&quot;renamefile&quot;)
<span class="fc" id="L170">	public static final ContextAction PSY_RENAMEFILE</span>
<span class="fc" id="L171">		=ContextAction.&lt;PsyString, PsyString&gt;ofBiConsumer(PsyFileSystem::psyRenameFile);</span>

	/**
	*	Context action of the {@code symlink} operator.
	*/
	@OperatorType(&quot;symlink&quot;)
<span class="fc" id="L177">	public static final ContextAction PSY_SYMLINK</span>
<span class="fc" id="L178">		=ContextAction.&lt;PsyString, PsyString&gt;ofBiConsumer(PsyFileSystem::psySymlink);</span>

	private static Path getPath(final PsyString oFileName)
	{
<span class="fc" id="L182">		return Paths.get(oFileName.stringValue());</span>
	}

	/**
	*	Creates a new directory with the given name.
	*
	*	@param oFileName a {@code string} representing the name of the directory being created.
	*	@throws PsyFileExistsException when the directory already exists.
	*	@throws PsyFileAccessDeniedException when the operation is prohibited due to a file
	*	permission or other access check.
	*
	*	@throws PsySecurityErrorException when security policy is violated.
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static void psyCreateDirectory(final PsyString oFileName)
		throws
			PsyFileExistsException,
			PsyFileAccessDeniedException,
			PsySecurityErrorException,
			PsyIOErrorException
	{
		try
		{
<span class="nc" id="L205">			Files.createDirectory(getPath(oFileName));</span>
		}
<span class="nc" id="L207">		catch(final FileAlreadyExistsException ex)</span>
		{
<span class="nc" id="L209">			throw new PsyFileExistsException(ex);</span>
		}
<span class="nc" id="L211">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L213">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L215">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L217">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L219">		catch(final IOException ex)</span>
		{
<span class="nc" id="L221">			throw new PsyIOErrorException(ex);</span>
<span class="nc" id="L222">		}</span>
<span class="nc" id="L223">	}</span>

	/*
	public static PsyString psyCreateTempFile(final PsyString oPrefix,
			final PsyString oSuffix, PsyString oDirectory)
		throws PsyIOErrorException, PsySecurityErrorException
	{
		try
		{
			Files.createTempFile()
			//java.io.File file=java.io.File.createTempFile(oPrefix.stringValue(),
			//		oSuffix.stringValue(), new java.io.File(oDirectory.stringValue()));
			//return new PsyString(file.getPath());
		}
		catch(final SecurityException ex)
		{
			throw new PsySecurityErrorException();
		}
		catch(final IOException ex)
		{
			throw new PsyIOErrorException();
		}
	}
	*/

	/**
	*	Deletes a file or empty directory with a given name.
	*
	*	@param oFileName a {@code string} representing the name of a file or directory.
	*	@throws PsyDirectoryNotEmptyException when the directory is not empty.
	*	@throws PsyFileNotFoundException when the file or directory does not exist.
	*	@throws PsyFileAccessDeniedException when the operation is prohibited due to a file
	*	permission or other access check.
	*	@throws PsySecurityErrorException when security policy is violated.
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static void psyDeleteFile(final PsyString oFileName)
		throws
			PsyFileNotFoundException,
			PsyFileAccessDeniedException,
			PsyDirectoryNotEmptyException,
			PsySecurityErrorException,
			PsyIOErrorException
	{
		try
		{
<span class="nc" id="L269">			Files.delete(getPath(oFileName));</span>
		}
<span class="nc" id="L271">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L273">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L275">		catch(final DirectoryNotEmptyException ex)</span>
		{
<span class="nc" id="L277">			throw new PsyDirectoryNotEmptyException(ex);</span>
		}
<span class="nc" id="L279">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L281">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L283">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L285">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L287">		catch(final IOException ex)</span>
		{
<span class="nc" id="L289">			throw new PsyIOErrorException(ex);</span>
<span class="nc" id="L290">		}</span>
<span class="nc" id="L291">	}</span>

	/**
	*	Copies a file to the target file.
	*
	*	@param oSourceName a {@code string} name of the file to copy.
	*	@param oTargetName a {@code string} name of the target file.
	*	@throws PsyDirectoryNotEmptyException TODO
	*	@throws PsyFileExistsException TODO
	*	@throws PsyFileNotFoundException when the file or directory does not exist.
	*	@throws PsyFileAccessDeniedException when the operation is prohibited due to a file
	*	permission or other access check.
	*	@throws PsySecurityErrorException when security policy is violated.
	*	@throws PsyIOErrorException when an I/O error occurs.
	*	@throws PsyUnsupportedException TODO
	*/
	public static void psyCopyFile(final PsyString oSourceName, final PsyString oTargetName)
		throws
			PsyDirectoryNotEmptyException,
			PsyFileAccessDeniedException,
			PsyFileExistsException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException,
			PsyUnsupportedException
	{
		try
		{
<span class="nc" id="L319">			Files.copy(getPath(oSourceName), getPath(oTargetName));</span>
		}
<span class="nc" id="L321">		catch(final UnsupportedOperationException ex)</span>
		{
<span class="nc" id="L323">			throw new PsyUnsupportedException(ex);</span>
		}
<span class="nc" id="L325">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L327">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L329">		catch(final DirectoryNotEmptyException ex)</span>
		{
<span class="nc" id="L331">			throw new PsyDirectoryNotEmptyException(ex);</span>
		}
<span class="nc" id="L333">		catch(final FileAlreadyExistsException ex)</span>
		{
<span class="nc" id="L335">			throw new PsyFileExistsException(ex);</span>
		}
<span class="nc" id="L337">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L339">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L341">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L343">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L345">		catch(final IOException ex)</span>
		{
<span class="nc" id="L347">			throw new PsyIOErrorException(ex);</span>
<span class="nc" id="L348">		}</span>
<span class="nc" id="L349">	}</span>

	/**
	*	{@return the target of a symbolic link}
	*
	*	@param oFileName the name of the target file.
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyString psyReadLink(final PsyString oFileName)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsyNotLinkException,
			PsySecurityErrorException
	{
		try
		{
<span class="fc" id="L367">			return new PsyString(Files.readSymbolicLink(getPath(oFileName)).toString());</span>
		}
<span class="fc" id="L369">		catch(final NoSuchFileException ex)</span>
		{
<span class="fc" id="L371">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="fc" id="L373">		catch(final NotLinkException ex)</span>
		{
<span class="fc" id="L375">			throw new PsyNotLinkException(ex);</span>
		}
<span class="nc" id="L377">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L379">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L381">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L383">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L385">		catch(final IOException ex)</span>
		{
<span class="nc" id="L387">			throw new PsyIOErrorException(ex);</span>
		}
	}

	/**
	*	Creates a symbolic link to a target.
	*
	*	@param oTarget the target of the symbolic link.
	*	@param oLink the path of the symbolic link to create.
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static void psySymlink(final PsyString oTarget, final PsyString oLink)
		throws
			PsyFileAccessDeniedException,
			PsyFileExistsException,
			PsyIOErrorException,
			PsySecurityErrorException,
			PsyUnsupportedException
	{
		try
		{
<span class="nc" id="L408">			Files.createSymbolicLink(getPath(oLink), getPath(oTarget));</span>
		}
<span class="nc" id="L410">		catch(final UnsupportedOperationException ex)</span>
		{
<span class="nc" id="L412">			throw new PsyUnsupportedException(ex);</span>
		}
<span class="nc" id="L414">		catch(final FileAlreadyExistsException ex)</span>
		{
<span class="nc" id="L416">			throw new PsyFileExistsException(ex);</span>
		}
<span class="nc" id="L418">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L420">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L422">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L424">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L426">		catch(final IOException ex)</span>
		{
<span class="nc" id="L428">			throw new PsyIOErrorException(ex);</span>
<span class="nc" id="L429">		}</span>
<span class="nc" id="L430">	}</span>

	/**
	*	Creates a new link (directory entry) for an existing file.
	*
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static void psyHardlink(final PsyString oExisting, final PsyString oLink)
		throws
			PsyFileAccessDeniedException,
			PsyFileExistsException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException,
			PsyUnsupportedException
	{
		try
		{
<span class="nc" id="L448">			Files.createLink(getPath(oLink), getPath(oExisting));</span>
		}
<span class="nc" id="L450">		catch(final UnsupportedOperationException ex)</span>
		{
<span class="nc" id="L452">			throw new PsyUnsupportedException(ex);</span>
		}
<span class="nc" id="L454">		catch(final FileAlreadyExistsException ex)</span>
		{
<span class="nc" id="L456">			throw new PsyFileExistsException(ex);</span>
		}
<span class="fc" id="L458">		catch(final NoSuchFileException ex)</span>
		{
<span class="fc" id="L460">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L462">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L464">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L466">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L468">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L470">		catch(final IOException ex)</span>
		{
<span class="nc" id="L472">			throw new PsyIOErrorException(ex);</span>
<span class="nc" id="L473">		}</span>
<span class="nc" id="L474">	}</span>

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static void psyRenameFile(final PsyString oFileName1, final PsyString oFileName2)
		throws
			PsyDirectoryNotEmptyException,
			PsyFileAccessDeniedException,
			PsyFileExistsException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="nc" id="L490">			Files.move(getPath(oFileName1), getPath(oFileName2));</span>
		}
<span class="fc" id="L492">		catch(final NoSuchFileException ex)</span>
		{
<span class="fc" id="L494">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L496">		catch(final FileAlreadyExistsException ex)</span>
		{
<span class="nc" id="L498">			throw new PsyFileExistsException(ex);</span>
		}
<span class="nc" id="L500">		catch(final DirectoryNotEmptyException ex)</span>
		{
<span class="nc" id="L502">			throw new PsyDirectoryNotEmptyException(ex);</span>
		}
<span class="nc" id="L504">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L506">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L508">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L510">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L512">		catch(final IOException ex)</span>
		{
<span class="nc" id="L514">			throw new PsyIOErrorException(ex);</span>
<span class="nc" id="L515">		}</span>
<span class="nc" id="L516">	}</span>

	public static PsyBoolean psyFileExists(final PsyString oFileName)
		throws PsySecurityErrorException
	{
		try
		{
<span class="fc" id="L523">			return PsyBoolean.of(Files.exists(getPath(oFileName)));</span>
		}
<span class="nc" id="L525">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L527">			throw new PsySecurityErrorException(ex);</span>
		}
	}

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyBoolean psyIsFile(final PsyString oFileName)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="fc" id="L543">			return PsyBoolean.of(Files.readAttributes(getPath(oFileName),</span>
					BasicFileAttributes.class,
<span class="fc" id="L545">					LinkOption.NOFOLLOW_LINKS).isRegularFile());</span>
		}
<span class="fc" id="L547">		catch(final NoSuchFileException ex)</span>
		{
<span class="fc" id="L549">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L551">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L553">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L555">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L557">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L559">		catch(final IOException ex)</span>
		{
<span class="nc" id="L561">			throw new PsyIOErrorException(ex);</span>
		}
	}

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyBoolean psyIsDirectory(final PsyString oFileName)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="fc" id="L577">			return PsyBoolean.of(Files.readAttributes(getPath(oFileName),</span>
					BasicFileAttributes.class,
<span class="fc" id="L579">					LinkOption.NOFOLLOW_LINKS).isDirectory());</span>
		}
<span class="fc" id="L581">		catch(final NoSuchFileException ex)</span>
		{
<span class="fc" id="L583">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L585">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L587">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L589">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L591">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L593">		catch(final IOException ex)</span>
		{
<span class="nc" id="L595">			throw new PsyIOErrorException(ex);</span>
		}
	}

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyBoolean psyIsSameFile(final PsyString oFileName1, final PsyString oFileName2)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="nc" id="L611">			return PsyBoolean.of(Files.isSameFile(</span>
<span class="nc" id="L612">					getPath(oFileName1), getPath(oFileName2)));</span>
		}
<span class="nc" id="L614">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L616">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L618">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L620">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L622">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L624">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L626">		catch(final IOException ex)</span>
		{
<span class="nc" id="L628">			throw new PsyIOErrorException(ex);</span>
		}
	}

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyBoolean psyIsSymlink(final PsyString oFileName)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="nc" id="L644">			return PsyBoolean.of(Files.readAttributes(getPath(oFileName),</span>
					BasicFileAttributes.class,
<span class="nc" id="L646">					LinkOption.NOFOLLOW_LINKS).isSymbolicLink());</span>
		}
<span class="nc" id="L648">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L650">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L652">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L654">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L656">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L658">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L660">		catch(final IOException ex)</span>
		{
<span class="nc" id="L662">			throw new PsyIOErrorException(ex);</span>
		}
	}

	/**
	*	{@return the {@code integer} representing the size (in bytes) for the file or directory with
	*	the given name}
	*
	*	@param oFileName a {@code string} representing the file name.
	*	@throws PsyFileAccessDeniedException when the operation is prohibited due to a file permission or
	*	other access check.
	*	@throws PsyFileNotFoundException when the file or directory does not exist.
	*	@throws PsySecurityErrorException when security policy is violated.
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyInteger psyFileSize(final PsyString oFileName)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="fc" id="L686">			return PsyInteger.of(Files.size(getPath(oFileName)));</span>
		}
<span class="fc" id="L688">		catch(final NoSuchFileException ex)</span>
		{
<span class="fc" id="L690">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L692">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L694">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L696">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L698">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L700">		catch(final IOException ex)</span>
		{
<span class="nc" id="L702">			throw new PsyIOErrorException(ex);</span>
		}
	}

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyInteger psyFileAccessTime(final PsyString oFileName)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="nc" id="L718">			return PsyInteger.of(Files.readAttributes(getPath(oFileName),</span>
<span class="nc" id="L719">					BasicFileAttributes.class).lastAccessTime().toMillis());</span>
		}
<span class="nc" id="L721">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L723">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L725">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L727">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L729">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L731">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L733">		catch(final IOException ex)</span>
		{
<span class="nc" id="L735">			throw new PsyIOErrorException(ex);</span>
		}
	}

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyInteger psyFileCreationTime(final PsyString oFileName)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="nc" id="L751">			return PsyInteger.of(Files.readAttributes(getPath(oFileName),</span>
<span class="nc" id="L752">					BasicFileAttributes.class).creationTime().toMillis());</span>
		}
<span class="nc" id="L754">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L756">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L758">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L760">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L762">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L764">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L766">		catch(final IOException ex)</span>
		{
<span class="nc" id="L768">			throw new PsyIOErrorException(ex);</span>
		}
	}

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyInteger psyFileModifiedTime(final PsyString oFileName)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="nc" id="L784">			return PsyInteger.of(Files.readAttributes(getPath(oFileName),</span>
<span class="nc" id="L785">					BasicFileAttributes.class).lastModifiedTime().toMillis());</span>
		}
<span class="nc" id="L787">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L789">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L791">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L793">			throw new PsySecurityErrorException(ex);</span>
		}
<span class="nc" id="L795">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L797">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L799">		catch(final IOException ex)</span>
		{
<span class="nc" id="L801">			throw new PsyIOErrorException(ex);</span>
		}
	}

	/**
	*	{@return a {@code string} representing the absolute name of the current directory}
	*/
	public static PsyString psyCurrentDirectory()
	{
<span class="nc" id="L810">		return new PsyString(Paths.get(&quot;&quot;).toAbsolutePath().toString());</span>
	}

	/**
	*	{@return a {@code string} representing the absolute path to given file}
	*
	*	@param oFileName a {@code string} representing file name.
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyString psyFileAbsolutePath(final PsyString oFileName)
		throws PsyIOErrorException
	{
		try
		{
<span class="fc" id="L824">			return new PsyString(Paths.get(oFileName.stringValue()).toAbsolutePath().toString());</span>
		}
<span class="nc" id="L826">		catch(final IOError ex)</span>
		{
<span class="nc" id="L828">			throw new PsyIOErrorException(ex);</span>
		}
	}

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyInteger psyFilePermissions(final PsyString oFileName)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="fc" id="L844">			final var permSet=Files.getPosixFilePermissions(getPath(oFileName));</span>
<span class="fc" id="L845">			long permissions=0L;</span>
<span class="fc bfc" id="L846" title="All 2 branches covered.">			for(final var p: permSet)</span>
<span class="fc" id="L847">				permissions|=256L&gt;&gt;p.ordinal();</span>
<span class="fc" id="L848">			return PsyInteger.of(permissions);</span>
		}
<span class="fc" id="L850">		catch(final NoSuchFileException ex)</span>
		{
<span class="fc" id="L852">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L854">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L856">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L858">		catch(final IOException ex)</span>
		{
<span class="nc" id="L860">			throw new PsyIOErrorException(ex);</span>
		}
<span class="nc" id="L862">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L864">			throw new PsySecurityErrorException(ex);</span>
		}
	}

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static void psyChangeFilePermissions(final PsyString oFileName, final PsyInteger oPermissions)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException
	{
		try
		{
<span class="nc" id="L880">			final var permissions=oPermissions.longValue();</span>
<span class="nc" id="L881">			final var permSet=new HashSet&lt;PosixFilePermission&gt;();</span>
<span class="nc" id="L882">			final var permValues=PosixFilePermission.values();</span>
<span class="nc bnc" id="L883" title="All 2 branches missed.">			for(int i=0; i&lt;=8; i++)</span>
<span class="nc bnc" id="L884" title="All 2 branches missed.">				if((permissions&amp;(256L&gt;&gt;i))!=0L)</span>
<span class="nc" id="L885">					permSet.add(permValues[i]);</span>
<span class="nc" id="L886">			Files.setPosixFilePermissions(getPath(oFileName), permSet);</span>

		}
<span class="nc" id="L889">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L891">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L893">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L895">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L897">		catch(final IOException ex)</span>
		{
<span class="nc" id="L899">			throw new PsyIOErrorException(ex);</span>
		}
<span class="nc" id="L901">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L903">			throw new PsySecurityErrorException(ex);</span>
<span class="nc" id="L904">		}</span>
<span class="nc" id="L905">	}</span>

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyObject psyFileAttribute(final PsyString oFileName, final PsyString oAttribute)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException,
			PsyTypeCheckException,
			PsyUndefinedException,
			PsyUnsupportedException
	{
		try
		{
<span class="nc" id="L922">			return toPsyTObject(Files.getAttribute(getPath(oFileName),</span>
<span class="nc" id="L923">					oAttribute.stringValue(), LinkOption.NOFOLLOW_LINKS));</span>
		}
<span class="nc" id="L925">		catch(final ClassCastException ex)</span>
		{
<span class="nc" id="L927">			throw new PsyTypeCheckException(ex);</span>
		}
<span class="nc" id="L929">		catch(final UnsupportedOperationException ex)</span>
		{
<span class="nc" id="L931">			throw new PsyUnsupportedException(ex);</span>
		}
<span class="nc" id="L933">		catch(final IllegalArgumentException ex)</span>
		{
<span class="nc" id="L935">			throw new PsyUndefinedException(ex);</span>
		}
<span class="nc" id="L937">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L939">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L941">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L943">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L945">		catch(final IOException ex)</span>
		{
<span class="nc" id="L947">			throw new PsyIOErrorException(ex);</span>
		}
<span class="nc" id="L949">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L951">			throw new PsySecurityErrorException(ex);</span>
		}
	}

	/**
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static void psyChangeFileAttribute(final PsyString oFileName, final PsyString oAttribute, final PsyString oValue)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsySecurityErrorException,
			PsyTypeCheckException,
			PsyUndefinedException,
			PsyUnsupportedException
	{
		try
		{
<span class="nc" id="L970">			Files.setAttribute(getPath(oFileName),</span>
<span class="nc" id="L971">					oAttribute.stringValue(), fromPsyTObject(oValue),</span>
					LinkOption.NOFOLLOW_LINKS);
		}
<span class="nc" id="L974">		catch(final ClassCastException ex)</span>
		{
<span class="nc" id="L976">			throw new PsyTypeCheckException(ex);</span>
		}
<span class="nc" id="L978">		catch(final UnsupportedOperationException ex)</span>
		{
<span class="nc" id="L980">			throw new PsyUnsupportedException(ex);</span>
		}
<span class="nc" id="L982">		catch(final IllegalArgumentException ex)</span>
		{
<span class="nc" id="L984">			throw new PsyUndefinedException(ex);</span>
		}
<span class="nc" id="L986">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L988">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L990">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L992">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L994">		catch(final IOException ex)</span>
		{
<span class="nc" id="L996">			throw new PsyIOErrorException(ex);</span>
		}
<span class="nc" id="L998">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L1000">			throw new PsySecurityErrorException(ex);</span>
<span class="nc" id="L1001">		}</span>
<span class="nc" id="L1002">	}</span>

	/**
	*	{@return a lazily populated stream, the elements of which are the entries in the directory}
	*	The listing is not recursive.}
	*
	*	@param oFileName the name of the directory.
	*	@throws PsyIOErrorException when an I/O error occurs.
	*/
	public static PsyFormalStream&lt;PsyString&gt; psyFiles(final PsyString oFileName)
		throws
			PsyFileAccessDeniedException,
			PsyFileNotFoundException,
			PsyIOErrorException,
			PsyNotDirectoryException,
			PsySecurityErrorException
	{
		try
		{
			//return new PsyStream(Files.list(getPath(oFileName)).&lt;PsyString&gt;map(
			//	(final var path)-&gt;new PsyString(path.toString())));
<span class="fc" id="L1023">			return PsyFormalStream.&lt;PsyString&gt;of(</span>
<span class="fc" id="L1024">					Files.list(getPath(oFileName)).&lt;PsyString&gt;map(</span>
<span class="fc" id="L1025">							(final var path)-&gt;new PsyString(path.toString())));</span>
		}
<span class="nc" id="L1027">		catch(final NoSuchFileException ex)</span>
		{
<span class="nc" id="L1029">			throw new PsyFileNotFoundException(ex);</span>
		}
<span class="nc" id="L1031">		catch(final NotDirectoryException ex)</span>
		{
<span class="nc" id="L1033">			throw new PsyNotDirectoryException(ex);</span>
		}
<span class="nc" id="L1035">		catch(final AccessDeniedException ex)</span>
		{
<span class="nc" id="L1037">			throw new PsyFileAccessDeniedException(ex);</span>
		}
<span class="nc" id="L1039">		catch(final IOException ex)</span>
		{
<span class="nc" id="L1041">			throw new PsyIOErrorException(ex);</span>
		}
<span class="nc" id="L1043">		catch(final SecurityException ex)</span>
		{
<span class="nc" id="L1045">			throw new PsySecurityErrorException(ex);</span>
		}
	}

	private static PsyObject toPsyTObject(final Object obj)
	{
<span class="nc bnc" id="L1051" title="All 5 branches missed.">		return switch(obj)</span>
			{
<span class="nc" id="L1053">				case String stringobj-&gt;new PsyString(stringobj);</span>
<span class="nc" id="L1054">				case Integer integerobj-&gt;PsyInteger.of(integerobj.longValue());</span>
<span class="nc" id="L1055">				case Long longobj-&gt;PsyInteger.of(longobj.longValue());</span>
<span class="nc" id="L1056">				case Boolean booleanobj-&gt;PsyBoolean.of(booleanobj);</span>
<span class="nc" id="L1057">				default-&gt;throw new ClassCastException();</span>
			};
	}

	private static Object fromPsyTObject(final PsyObject o)
	{
<span class="nc bnc" id="L1063" title="All 4 branches missed.">		return switch(o)</span>
			{
<span class="nc" id="L1065">				case PsyString oName-&gt;oName.stringValue();</span>
<span class="nc" id="L1066">				case PsyInteger oInteger-&gt;oInteger.longValue();</span>
<span class="nc" id="L1067">				case PsyBoolean oBoolean-&gt;oBoolean.booleanValue();</span>
<span class="nc" id="L1068">				default-&gt;throw new ClassCastException();</span>
			};
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202410190809</span></div></body></html>